# 토정비결 tojung 테이블 내용 증강 프롬프트

## 🎯 목적
토정비결 앱의 핵심 데이터인 tojung 테이블의 운세 내용을 풍성하고 전문적인 수준으로 업그레이드합니다.

---

## 📁 입출력 구조

```
input/
└── tojung.sql              # 원본 INSERT문 파일

output/
└── tojung_enhanced.sql     # 증강된 INSERT문 파일
```

---

## 🔒 핵심 제약 조건

### 1. 테이블 구조 불변
```sql
-- 기존 컬럼 구조 그대로 유지
INSERT INTO public.tojung (
    id,         -- 순번 (변경 금지)
    num,        -- 운세 코드 예: '000', '001', ... '071' (변경 금지)
    total,      -- 연간 종합 운세
    jan,        -- 1월 운세
    feb,        -- 2월 운세
    mar,        -- 3월 운세
    apr,        -- 4월 운세
    may,        -- 5월 운세
    jun,        -- 6월 운세
    jul,        -- 7월 운세
    aug,        -- 8월 운세
    sep,        -- 9월 운세
    oct,        -- 10월 운세
    nov,        -- 11월 운세
    "dec",      -- 12월 운세
    created_at, -- 생성일시 (변경 금지)
    nation      -- 언어 코드: 'k'(한국어), 'e'(영어), 'j'(일본어), 'c'(중국어) (변경 금지)
) VALUES (...);
```

### 2. INSERT문 갯수 동일
- 원본 tojung.sql의 INSERT문 갯수와 결과물의 INSERT문 갯수가 **정확히 일치**해야 함
- id, num, created_at, nation 값은 **절대 변경 금지**

### 3. 다국어 동일 내용
- 같은 num 코드를 가진 4개 언어(k, e, j, c)의 내용은 **의미상 동일**해야 함
- 각 언어의 자연스러운 표현으로 번역

---

## 📝 콘텐츠 증강 가이드라인

### total (연간 종합 운세) - 목표: 800~1200자

기존 부실한 예시:
```
운에 구름이 없으니 바다와 하늘이 모두다 편하하겠습니다...
```

증강된 예시 (샘플 참조):
```
2026년은 변화와 도전의 해가 될 것입니다. 상반기에는 신중함을, 하반기에는 적극성을 
발휘하는 것이 좋겠습니다. 재물운은 4월과 9월이 특히 길하며, 이 시기에 투자나 재테크를 
시도하면 좋은 결실을 맺을 가능성이 높습니다. 직업 영역에서는 5월과 10월에 업무 성과가 
인정받을 수 있습니다. 건강 면에서는 6월과 11월에 과로나 스트레스에 주의가 필요합니다.
인간관계는 질적 성장을 이루는 시기로, 동료나 친구와의 협력이 중요합니다. 전반적으로 
도전과 기회가 공존하는 한 해이니, 균형 잡힌 접근이 필요합니다.
```

**포함해야 할 요소:**
- 연간 전체 운세 흐름 개요
- 재물운/직업운/건강운/인간관계운 핵심 요약
- 상반기/하반기 구분 조언
- 길한 시기와 주의할 시기 언급
- 구체적인 행동 지침

---

### 월별 운세 (jan ~ dec) - 목표: 200~350자

기존 부실한 예시:
```
정월과 이월에는 비로소 의복을 얻게 되겠습니다. 근심이 사라지고...
```

증강된 예시:
```
이달은 재물과 인간관계 모두 좋은 기운이 흐르는 달입니다. 투자나 재테크를 시도하기 
좋으며, 새로운 인맥 형성에도 유리합니다. 특히 중순경에 예상치 못한 기회가 찾아올 수 
있으니 열린 마음으로 준비하세요. 다만, 건강 관리에는 신경을 써야 합니다. 과로를 
피하고 충분한 휴식을 취하세요. 동쪽이나 남쪽 방향의 활동이 길합니다.
```

**포함해야 할 요소:**
- 해당 월의 전체적인 운세 기조
- 재물/직업/건강/인간관계 중 핵심 1-2개
- 길일/흉일 또는 길한 시기 언급
- 구체적인 조언 및 주의사항
- 길방위 언급 (선택)

---

## 🌏 다국어 번역 가이드

### 한국어 (nation='k')
- 자연스러운 구어체 사용
- "~입니다", "~겠습니다" 체
- 토정비결 특유의 고풍스러운 표현 유지
- 예: "길한 기운이 감도니...", "재물이 들어오는 길월..."

### 영어 (nation='e')
- 자연스럽고 직관적인 표현
- 동양 운세 특유의 분위기 유지
- 예: "Fortune smiles upon you...", "A propitious month for..."

### 일본어 (nation='j')
- 丁寧語(정중어) 사용
- 운세 특유의 표현 활용
- 예: "運気が上昇し...", "金運に恵まれる月です..."

### 중국어 간체 (nation='c')
- 简体字 사용
- 운세/명리학 관련 표현 활용
- 예: "财运亨通...", "吉星高照..."

---

## ⚙️ 작업 프로세스

### Step 1: 원본 분석
```bash
# input/tojung.sql 파일 읽기
# 각 INSERT문 파싱
# id, num, nation별로 그룹핑
```

### Step 2: 내용 증강 (한국어 먼저)
```
각 num 코드별로:
1. 기존 total 내용을 기반으로 800~1200자로 확장
2. 기존 월별 내용을 기반으로 각 200~350자로 확장
3. 토정비결 샘플 스타일 적용
```

### Step 3: 다국어 번역
```
한국어 완성 후:
1. 영어(e) 버전 생성
2. 일본어(j) 버전 생성
3. 중국어(c) 버전 생성
※ 같은 num의 4개 언어는 의미상 동일해야 함
```

### Step 4: INSERT문 생성
```sql
-- id, num, created_at, nation은 원본 값 유지
-- total, jan~dec 컬럼만 증강된 내용으로 교체
INSERT INTO public.tojung (...) VALUES (
    원본_id,
    원본_num,
    '증강된_total_내용',
    '증강된_jan_내용',
    ...
    '증강된_dec_내용',
    원본_created_at,
    원본_nation
);
```

### Step 5: 검증
```
□ INSERT문 갯수가 원본과 동일한가?
□ 모든 id, num, created_at, nation이 원본과 일치하는가?
□ 같은 num의 k, e, j, c 버전이 의미상 동일한가?
□ SQL 문법 오류가 없는가?
□ 문자열 이스케이프가 올바른가? (작은따옴표 '' 처리)
```

---

## 📋 품질 체크리스트

### 내용 품질
- [ ] total이 800~1200자 범위인가?
- [ ] 월별 운세가 200~350자 범위인가?
- [ ] 재물/직업/건강/인간관계 운이 균형있게 포함되었는가?
- [ ] 구체적인 조언과 행동 지침이 있는가?
- [ ] 길한 시기와 주의할 시기가 명시되었는가?

### 기술 품질
- [ ] INSERT문 갯수가 원본과 정확히 일치하는가?
- [ ] id, num, created_at, nation 값이 변경되지 않았는가?
- [ ] SQL 문법이 올바른가?
- [ ] 작은따옴표가 올바르게 이스케이프 되었는가? (' → '')
- [ ] 줄바꿈 문자가 올바르게 처리되었는가?

### 다국어 품질
- [ ] 같은 num의 k, e, j, c가 의미상 동일한가?
- [ ] 각 언어가 자연스러운가?
- [ ] 언어별 특유의 운세 표현이 사용되었는가?

---

## 🎨 운세 내용 스타일 참고

### 긍정적 운세 표현 (길운)
| 한국어 | 영어 | 일본어 | 중국어 |
|--------|------|--------|--------|
| 재물이 들어오는 길월 | A propitious month for wealth | 金運に恵まれる月 | 财运亨通之月 |
| 귀인이 도와주니 | With noble assistance | 貴人の助けあり | 贵人相助 |
| 하는 일마다 성공 | Success in all endeavors | 万事順調 | 事事顺利 |
| 길한 기운이 감돈다 | Auspicious energy surrounds | 吉運が巡る | 吉星高照 |

### 주의 필요 표현 (흉운)
| 한국어 | 영어 | 일본어 | 중국어 |
|--------|------|--------|--------|
| 구설수에 주의 | Beware of gossip | 口舌の災いに注意 | 谨防口舌是非 |
| 건강관리에 신경 | Take care of health | 健康管理に注意 | 注意健康 |
| 과욕을 삼가라 | Avoid excessive greed | 欲を控えよ | 切忌贪心 |
| 신중함이 필요 | Prudence is required | 慎重さが必要 | 需要谨慎 |

---

## 📌 최종 출력

```
output/
└── tojung_enhanced.sql
```

파일 내용:
```sql
-- 토정비결 tojung 테이블 증강 데이터
-- 생성일: YYYY-MM-DD
-- 원본 INSERT문 갯수: XXX개
-- 증강 INSERT문 갯수: XXX개 (동일)

INSERT INTO public.tojung (...) VALUES (...);
INSERT INTO public.tojung (...) VALUES (...);
...
```

---

## ⚠️ 주의사항

1. **절대 변경 금지 필드**: id, num, created_at, nation
2. **SQL 인젝션 방지**: 내용에 작은따옴표(')가 있으면 반드시 이스케이프('')
3. **인코딩**: UTF-8 유지
4. **갯수 검증**: 작업 완료 후 반드시 INSERT문 갯수 검증
5. **언어 일관성**: 같은 num의 4개 언어는 반드시 의미상 동일

---

## 🔄 대용량 파일 처리 방법

### 문제
- `tojung.sql` 파일이 1.1MB (약 100,000+ 토큰)으로 한 번에 읽기 불가
- AI 모델의 컨텍스트 제한으로 전체 파일을 한 번에 처리할 수 없음

### 해결: 배치(Batch) 분할 처리

```
총 INSERT문: 284개
권장 배치 크기: 4개 (같은 num의 k, e, j, c를 한 묶음으로)
총 배치 수: 71개 (284 ÷ 4)
```

### 배치 처리 프로세스

```bash
# Step 1: 원본 파일을 num별로 분할
# 같은 num을 가진 4개 언어(k, e, j, c)를 하나의 배치로 묶음

input/
├── tojung.sql              # 원본 전체 파일
└── batches/                # 분할된 배치 폴더
    ├── batch_000.sql       # num='000'의 k, e, j, c (4개)
    ├── batch_001.sql       # num='001'의 k, e, j, c (4개)
    ├── ...
    └── batch_070.sql       # num='070'의 k, e, j, c (4개)

# Step 2: 각 배치별로 증강 처리
# 한 번에 하나의 배치(4개 INSERT문)만 처리

# Step 3: 증강된 배치를 하나로 병합
output/
└── tojung_enhanced.sql     # 모든 배치 병합 결과
```

### 배치 분할 스크립트 예시

```bash
# input/tojung.sql을 num별로 분할
mkdir -p input/batches

# num 코드별로 그룹핑하여 분할
# (실제 구현 시 적절한 스크립트 사용)
```

### 배치 처리 시 체크리스트
- [ ] 각 배치가 같은 num의 4개 언어를 포함하는가?
- [ ] 배치 처리 후 누락된 INSERT문이 없는가?
- [ ] 최종 병합 시 순서가 올바른가?
- [ ] 총 INSERT문 갯수가 284개로 유지되는가?
